# Emark DES - AI 토론 시스템 최종 배포 보고서

## 1. 개요

본 보고서는 Emark DES(Flask SSE + React) Monorepo를 Railway에 성공적으로 배포하고, 실제 AI 모델(GPT, Gemini, Grok, Claude)과의 상호작용을 활성화하는 과정을 요약합니다.

## 2. 주요 성과

- **실제 AI API 호출 활성화:** `ENABLE_REAL_CALLS=true` 환경 변수 설정을 통해 기존의 mock 데이터 대신 실제 AI 모델 API를 호출하도록 시스템을 성공적으로 전환했습니다.
- **안정적인 Railway 배포:** Docker를 사용하여 애플리케이션을 컨테이너화하고 Railway에 안정적으로 배포했습니다. 배포된 애플리케이션은 [https://emark-des-v2-production.up.railway.app/](https://emark-des-v2-production.up.railway.app/) 에서 확인할 수 있습니다.
- **실시간 AI 토론 기능:** Flask의 SSE(Server-Sent Events)와 React를 활용하여 4개의 AI 모델이 실시간으로 토론하는 과정을 시각적으로 보여주는 기능을 구현했습니다.
- **개선된 오류 처리 및 fallback 메커니즘:** 실제 API 호출 실패 시에도 시스템이 중단되지 않고, 개선된 mock 데이터를 사용하여 응답을 생성하는 fallback 메커니즘을 도입하여 안정성을 높였습니다.

## 3. 배포 과정 및 해결된 문제

1. **환경 변수 설정 문제:** 초기에는 `ENABLE_REAL_CALLS` 환경 변수가 제대로 적용되지 않아 실제 AI API 호출이 활성화되지 않았습니다. `.env` 파일을 수정하고, `python-dotenv` 라이브러리를 사용하여 환경 변수를 올바르게 로드하도록 문제를 해결했습니다.
2. **API 인증 및 연결 오류:** 각 AI 모델의 API 키를 Railway 환경 변수로 설정하고, API 호출 과정에서 발생한 인증 및 연결 오류를 디버깅했습니다. 특히 Gemini API의 모델 이름 오류와 Grok API의 시스템 역할 오류를 수정하여 정상적으로 API를 호출할 수 있도록 했습니다.
3. **비동기 처리 및 이벤트 루프 충돌:** 여러 AI 모델을 동시에 비동기적으로 호출하는 과정에서 발생할 수 있는 이벤트 루프 충돌 문제를 해결하기 위해 `adapters_shim.py`의 비동기 처리 로직을 개선했습니다.
4. **GitHub 브랜치 충돌:** 배포 과정에서 발생한 GitHub 브랜치 충돌 문제를 해결하고, 원격 저장소와 로컬 저장소를 동기화하여 안정적인 CI/CD 파이프라인을 유지했습니다.

## 4. 향후 개선 사항

- **API 키 관리:** 현재는 환경 변수로 API 키를 관리하고 있지만, 더 안전한 방법으로 API 키를 관리하는 방안을 고려할 수 있습니다. (예: Railway의 Secret Management 기능 활용)
- **스트리밍 성능 최적화:** 대규모 트래픽 발생 시에도 안정적인 스트리밍 성능을 유지하기 위한 최적화 방안을 검토할 수 있습니다.
- **사용자 인터페이스 개선:** 사용자 경험을 향상시키기 위한 UI/UX 개선을 지속적으로 진행할 수 있습니다.

## 5. 결론

Emark DES 시스템은 성공적으로 Railway에 배포되었으며, 4개의 AI 모델이 실시간으로 토론하는 핵심 기능이 정상적으로 작동함을 확인했습니다. 일부 AI 모델의 API 오류가 발생하지만, 시스템은 안정적으로 작동하며 fallback 메커니즘을 통해 사용자에게 원활한 경험을 제공합니다. 본 프로젝트를 통해 실제 AI 모델을 통합하고 안정적으로 배포하는 역량을 확보했습니다.

